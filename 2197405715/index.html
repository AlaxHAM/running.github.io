<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Django 整理 | Legacy</title><meta name="description" content="Django 整理"><meta name="keywords" content="Django"><meta name="author" content="Legacy"><meta name="copyright" content="Legacy"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Django 整理"><meta name="twitter:description" content="Django 整理"><meta name="twitter:image" content="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover17.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Django 整理"><meta property="og:url" content="http://alexham.top/2197405715/"><meta property="og:site_name" content=""><meta property="og:description" content="Django 整理"><meta property="og:image" content="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover17.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://alexham.top/2197405715/"><link rel="prev" title="LeetCode 原题" href="http://alexham.top/887545606/"><link rel="next" title="JavaScript 逆向爬取实例(下)" href="http://alexham.top/3660878595/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?e489393b06c7f499de65869025d36fa2";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Legacy's blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 淘影乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">24</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">14</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">24</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 淘影乐</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#MVC-和-MTV-架构"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">MVC 和 MTV 架构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#MVC"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">MVC</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#MTV"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">MTV</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#WSGI-和-uWSGI"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">WSGI 和 uWSGI</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Django-请求生命周期"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">Django 请求生命周期</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Django-基本命令"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">Django 基本命令</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#URL-配置"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">URL 配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#url-的注意点"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text">url 的注意点</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#无名分组和有名分组"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text">无名分组和有名分组</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#url-分发"><span class="toc_mobile_items-number">5.3.</span> <span class="toc_mobile_items-text">url 分发</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#url-反向解析"><span class="toc_mobile_items-number">5.4.</span> <span class="toc_mobile_items-text">url 反向解析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#url-名称空间"><span class="toc_mobile_items-number">5.5.</span> <span class="toc_mobile_items-text">url 名称空间</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#HttpRequests-和-HttpResponse-对象"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">HttpRequests 和 HttpResponse 对象</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#HttpRequests-对象"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text">HttpRequests 对象</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#HttpResponse-对象"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text">HttpResponse 对象</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#FBV-和-CBV"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">FBV 和 CBV</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#模板语法"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">模板语法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#模板语法自带的过滤器方法"><span class="toc_mobile_items-number">8.1.</span> <span class="toc_mobile_items-text">模板语法自带的过滤器方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#自定义标签与过滤器"><span class="toc_mobile_items-number">8.2.</span> <span class="toc_mobile_items-text">自定义标签与过滤器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#继承"><span class="toc_mobile_items-number">8.3.</span> <span class="toc_mobile_items-text">继承</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#MVC-和-MTV-架构"><span class="toc-number">1.</span> <span class="toc-text">MVC 和 MTV 架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MVC"><span class="toc-number">1.1.</span> <span class="toc-text">MVC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MTV"><span class="toc-number">1.2.</span> <span class="toc-text">MTV</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WSGI-和-uWSGI"><span class="toc-number">2.</span> <span class="toc-text">WSGI 和 uWSGI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Django-请求生命周期"><span class="toc-number">3.</span> <span class="toc-text">Django 请求生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Django-基本命令"><span class="toc-number">4.</span> <span class="toc-text">Django 基本命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL-配置"><span class="toc-number">5.</span> <span class="toc-text">URL 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#url-的注意点"><span class="toc-number">5.1.</span> <span class="toc-text">url 的注意点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#无名分组和有名分组"><span class="toc-number">5.2.</span> <span class="toc-text">无名分组和有名分组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#url-分发"><span class="toc-number">5.3.</span> <span class="toc-text">url 分发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#url-反向解析"><span class="toc-number">5.4.</span> <span class="toc-text">url 反向解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#url-名称空间"><span class="toc-number">5.5.</span> <span class="toc-text">url 名称空间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HttpRequests-和-HttpResponse-对象"><span class="toc-number">6.</span> <span class="toc-text">HttpRequests 和 HttpResponse 对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HttpRequests-对象"><span class="toc-number">6.1.</span> <span class="toc-text">HttpRequests 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HttpResponse-对象"><span class="toc-number">6.2.</span> <span class="toc-text">HttpResponse 对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FBV-和-CBV"><span class="toc-number">7.</span> <span class="toc-text">FBV 和 CBV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模板语法"><span class="toc-number">8.</span> <span class="toc-text">模板语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#模板语法自带的过滤器方法"><span class="toc-number">8.1.</span> <span class="toc-text">模板语法自带的过滤器方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义标签与过滤器"><span class="toc-number">8.2.</span> <span class="toc-text">自定义标签与过滤器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#继承"><span class="toc-number">8.3.</span> <span class="toc-text">继承</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover17.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">Django 整理</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-07-13<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-07-29</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/python-web%E6%A1%86%E6%9E%B6/">python web框架</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/python-web%E6%A1%86%E6%9E%B6/Django/">Django</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">6.1k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 22 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2197405715/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2197405715/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h3 id="MVC-和-MTV-架构"><a href="#MVC-和-MTV-架构" class="headerlink" title="MVC 和 MTV 架构"></a>MVC 和 MTV 架构</h3><h4 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h4><p>​    MVC 模型是 web 服务器开发领域里著名的一个模型，所谓的 MVC 就是把 web 应用分为，<strong>模型（Model），控制器（Controller），视图（View）</strong>，三者之间以一种 <strong>插件式</strong> 的，<strong>松耦合</strong> 的方式连接在一起</p>
<p>​    <strong>模型 M：</strong>负责业务对象与数据库的映射关系（ORM）</p>
<p>​    <strong>视图 V：</strong>提供与用户进行交互的页面</p>
<p>​    <strong>控制器 C：</strong>接收用户的输入调用模型和视图完成用户请求</p>
<p><a href="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/MVC.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="img/md5.jpg" class="fancybox"><img alt="img/md5.jpg" title="img/md5.jpg" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/MVC.jpg" class="lazyload"></a> </p>
<h4 id="MTV"><a href="#MTV" class="headerlink" title="MTV"></a>MTV</h4><p>​    Django用的是 MTV 模型，但是本质上是和 MVC 一样的，也是为了将各组件之间保持松耦合关系，但是定义上有些不同；依然是分为三块：<strong>模型（model），模板（template），视图（view）</strong> </p>
<p>​    <strong>模型 M：</strong>与 MVC 一样是负责业务对象和数据的关系映射，对数据库进行调取和处理，即数据存取层</p>
<p>​    <strong>模板 T：</strong>利用模板语法进行html和数据的渲染展示，即表现层</p>
<p>​    <strong>视图 V：</strong>负责业务的逻辑，并在适当时调用 model 和 template，即业务逻辑层</p>
<p>​    除了这三层之外，还有一个 <strong>Controller</strong> 即 <strong>URL分发器</strong>，作用是将一个个 url 的页面请求分发给匹配路由的视图来处理</p>
<p><a href="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/MTV.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="img/md5.jpg" class="fancybox"><img alt="img/md5.jpg" title="img/md5.jpg" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/MTV.jpg" class="lazyload"></a> </p>
<h3 id="WSGI-和-uWSGI"><a href="#WSGI-和-uWSGI" class="headerlink" title="WSGI 和 uWSGI"></a>WSGI 和 uWSGI</h3><p>​    <strong>WSGI：</strong>web service getaway interface，<strong>web服务器网关接口</strong>，是一个 web服务器 与 应用服务器 通信的 <strong>一种规范协议</strong>，<strong>WSGI 是 web服务器 与 web应用程序 或 应用框架 之间的一种的接口</strong></p>
<p>​    <strong>uWSGI：</strong>是一个 <strong>web服务器</strong>，实现了 <strong>WSGI，uwsgi，http 协议</strong></p>
<p>​    <strong>uwsgi：</strong>它与 WSGI 一样，是 uWSGI服务器 的 <strong>通信协议</strong></p>
<p><a href="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/WSGI.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="img/md5.jpg" class="fancybox"><img alt="img/md5.jpg" title="img/md5.jpg" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/WSGI.jpg" class="lazyload"></a> </p>
<p>​    补充点：</p>
<p>​    <strong>Nginx：</strong>nginx服务器 的出现针对于大访问量的情况，对分布式服务器进行请求的分发，同时它还可以实现反向代理</p>
<h3 id="Django-请求生命周期"><a href="#Django-请求生命周期" class="headerlink" title="Django 请求生命周期"></a>Django 请求生命周期</h3><p>​    1）按照 wsgi 协议，封装请求后交给 Django 框架</p>
<p>​    2）请求到达中间件，并对请求进行校验或是在请求对象中添加其他的相关数据，例如：csrf，request.session</p>
<p>​    3）通过中间件后，由路由控制器对请求 url 进行匹配，然后分发给对应的视图函数</p>
<p>​    4）视图函数进行业务逻辑的处理并返回</p>
<p>​    5）返回的需要再次经过中间件，对要响应的数据进行处理</p>
<p>​    6）通过 wsgi 再将响应结果和内容发送给浏览器</p>
<h3 id="Django-基本命令"><a href="#Django-基本命令" class="headerlink" title="Django 基本命令"></a>Django 基本命令</h3><p>​    <strong>安装：</strong> <code>pip3 install django</code>， 直接安装会从原地址去下载，会非常非常慢甚至会中断失败，所以可以通过国内的一些镜像源去安装，比如豆瓣源：<code>pip3 install -i https://pypi.douban.com/simple/ django</code></p>
<p>​    <strong>创建 django 项目：</strong> <code>django-admin.py startproject 项目名称</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">项目名称文件夹</span><br><span class="line">|---- manage.py             # 启动文件 </span><br><span class="line">|---- 项目文件夹</span><br><span class="line">    |---- __init__.py</span><br><span class="line">    |---- settings.py       # 包含一些数据库等配置信息</span><br><span class="line">    |---- urls.py           # 全局路由与视图函数映射文件，但并不需要将所有 url 全写在这个文件中 </span><br><span class="line">    |---- wsgi.py           # 关于 wsgi 协议的配置设置</span><br></pre></td></tr></table></figure></div>

<p>​    <strong>创建应用：</strong> <code>python3 manage.py startapp 应用名称</code>，该命令会在项目文件夹下创建一个应用的文件夹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">应用文件夹</span><br><span class="line">|---- __init__.py</span><br><span class="line">|---- admin.py</span><br><span class="line">|---- apps.py</span><br><span class="line">|---- migrations              # 进行迁移时，会产生文件在该文件夹下</span><br><span class="line">    |---- __init__.py</span><br><span class="line">|---- models.py</span><br><span class="line">|---- test.py</span><br><span class="line">|---- views.py</span><br></pre></td></tr></table></figure></div>

<p>​    <strong>启动项目：</strong> <code>python3 manage.py runserver (ip:port)</code>，括号中的 ip 和端口可以不用显式输入，默认会在本地的 8000 端口启动这个项目，然后在浏览器输入 <a href="http://127.0.0.1:8000/" target="_blank" rel="noopener">http://127.0.0.1:8000/</a> 就可以访问了，会跳转到 django 自带一个首页界面，会显示成功启动项目以及 django 的版本信息</p>
<p>​    <strong>模型创建和数据库同步：</strong> </p>
<p>​    <code>python3 manage.py makemigrations</code>，创建迁移记录文件，即将模型（models）文件中对数据库的操作，以文件形式进行记录，该命令执行后，会在 migrations 文件夹下生成一个 <code>0001_initial.py</code> 的文件，可以查看这个文件会发现其实和在 models.py 中的代码是相似的，只是做了一些处理且每一次创建迁移都会生成一个类似 <code>0001_initial.py</code>  的文件，需要知道的是 ‘makemigrations’ 的命令完成后，并不会影响到数据库</p>
<p>​    <code>python3 manage.py migrate</code>，即使数据库与 models.py 中的 模型集 和 迁移文件 进行同步，这个命令会直接对数据库进行操作，所以 ‘migrate’ 命令必然是在 ‘makemigrations’ 之后进行操作的</p>
<h3 id="URL-配置"><a href="#URL-配置" class="headerlink" title="URL 配置"></a>URL 配置</h3><p>​    在应用创建完成前，项目的目的下有一个全局的 urls.py ，即该文件所存储的就是网站中所有的 url 配置，不过通常来说，将应用的 url 放在全局的 urls 中显然有些不妥，不仅不方便对应查看，也不能体现根据应用实现 url 的解耦，所以都会在创建的应用文件夹中另外创建一个 urls.py 的文件，将该应用的 url 记录在该应用的 urls 中，且在全局 urls 文件中去引用它，这样全局的 urls 中只需要给一个对应创建应用的 url 就能指向到应用内部的创建的 urls 去匹配和分发，以此实现解耦</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># urls.py 配置</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(正则表达式, views视图函数，参数，别名),   <span class="comment"># 在 django 1.1.x 的版本使用的 url 方法去配置理由，而在 2.2.x 的版本开始使用的是 path 和 re_path</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则表达式，即用来对 url 去进行匹配</span></span><br><span class="line"><span class="comment"># views 视图函数，即匹配成功后回调的 target，通常是一个视图函数名或是视图函数的路径</span></span><br><span class="line"><span class="comment"># 参数，可选的配置项，用来将这个默认参数传递给视图函数，是字典格式的</span></span><br><span class="line"><span class="comment"># 别名，可选的配置项，别名主要用来简化 url，方便在其他地方可以直接利用别名去找指定 url</span></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># django 1.1.x，urls 配置</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url   <span class="comment"># 用 url 需要引入</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^admin/$'</span>, admin.site.urls),</span><br><span class="line">    url(<span class="string">r'^index/$'</span>, views.index), <span class="comment"># 普通路径</span></span><br><span class="line">    url(<span class="string">r'^articles/([0-9]&#123;4&#125;)/$'</span>, views.articles), <span class="comment"># 正则路径</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># django 2.2.x，urls 配置</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> re_path    <span class="comment"># 用re_path 需要引入</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),    <span class="comment"># admin 的路由是 django 自带的后台管理应用</span></span><br><span class="line">    path(<span class="string">'index/'</span>, views.index),   <span class="comment"># 普通路径</span></span><br><span class="line">    re_path(<span class="string">r'^articles/([0-9]&#123;4&#125;)/$'</span>, views.articles), <span class="comment"># 正则路径</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># path，用作普通路径，不需要手动添加正则的开始和结尾的限制符号</span></span><br><span class="line"><span class="comment"># re_path，和 1.1.x 中的 url 方法一致，需要手动去添加限制符（^ ，$）</span></span><br></pre></td></tr></table></figure></div>

<h4 id="url-的注意点"><a href="#url-的注意点" class="headerlink" title="url 的注意点"></a>url 的注意点</h4><p>​    1）url 的正则匹配由上至下逐一匹配，一旦有正则表达式满足 url 的匹配，就不会继续往后进行，所以在 url 的配置顺序上，如果有相似度极高的 url ，就需要做些配置顺序上的调整或是直接修改 url ，让每一个 url 可以被单独匹配，而不会在因为相似情况下，被前面的 url 匹配导致真正匹配的 url 不能匹配到，从而可能导致出错</p>
<p>​    2）url 的正则表达式前面不需要加上反斜杠 ‘/‘，因为浏览器会默认在 8080 后面加上 ‘/‘，发送请求后 url 是携带着这个反斜杠的</p>
<p>​    3）在使用 url 和 re_path 方法中设置正则表达式，建议在表达式字符串前加上 ‘r’，来表示一个原始字符串和防止转义</p>
<p>​    4）在 url 的正则匹配中，如果有参数，需要使用 ‘()’，例如   <code>re_path(r&#39;^articles/([0-9]{4})/$&#39;, views.articles)</code>，匹配这个 url 的地址会携带后面 4 个数字，一旦 url 匹配上，这个 4 位数的参数会被一起传递给视图函数 articles，那么在这个函数中，就需要定义一个形参去接受这个参数</p>
<p>​    5）即明确名字的参数，例如   <code>path(&#39;articles/&lt;int:year&gt;/&lt;int:month&gt;/&#39;, views.month_archive),</code>，这个 url 中使用 ‘&lt;&gt;’ 明确定义了参数，那么在视图函数中 views.month_archive 的形参就需要明确定义 year 和 mouth</p>
<h4 id="无名分组和有名分组"><a href="#无名分组和有名分组" class="headerlink" title="无名分组和有名分组"></a>无名分组和有名分组</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 无名分组</span></span><br><span class="line"><span class="comment"># urls 中的配置</span></span><br><span class="line">url(<span class="string">r'^articles/(\d&#123;4&#125;)/(\d&#123;2&#125;)/$'</span>, views.year_month), </span><br><span class="line"></span><br><span class="line"><span class="comment"># views 的配置</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">year_month</span><span class="params">(request, y, m)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line">此时，请求 url = 'http://127.0.0.1:8000/articles/2020/05/'</span><br><span class="line">进入到视图处理时， 就是 year_month(requset,<span class="number">2020</span>,<span class="number">05</span>)   <span class="comment"># 匹配的 url 会按位置传递参数</span></span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># 有名分组</span></span><br><span class="line"><span class="comment"># 应用的 urls.py </span></span><br><span class="line">url(<span class="string">r'^articles/(?P&lt;year&gt;\d&#123;4&#125;)/(?P&lt;month&gt;\d&#123;2&#125;)/$'</span>, views.year_month) </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># views.py</span></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, HttpResponse</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">year_month</span><span class="params">(request, year, month)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">f'year:<span class="subst">&#123;year&#125;</span>, month:<span class="subst">&#123;month&#125;</span>'</span>)   <span class="comment"># HttpResponse 可以时间将指定的字符渲染到页面上</span></span><br></pre></td></tr></table></figure></div>

<p>​    此时，请求 url = ‘<a href="http://127.0.0.1:8000/articles/2020/05/&#39;，进入到视图处理时，" target="_blank" rel="noopener">http://127.0.0.1:8000/articles/2020/05/&#39;，进入到视图处理时，</a> 就是 year_month(requset, year=2020, month=05)</p>
<p><a href="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/views1.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="img/md5.jpg" class="fancybox"><img alt="img/md5.jpg" title="img/md5.jpg" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/views1.jpg" class="lazyload"></a> </p>
<h4 id="url-分发"><a href="#url-分发" class="headerlink" title="url 分发"></a>url 分发</h4><p>​    前面说到了，对于 urls 配置可以根据应用内部创建 urls.py 的文件去实现解耦，这就是 url 的分发，但是前提是需要在全局的 urls 中去配置要分发的路径</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">Including another URLconf</span><br><span class="line">    1. Import the include() function: from django.urls import include, path</span><br><span class="line">    2. Add a URL to urlpatterns:  path(&#39;blog&#x2F;&#39;, include(&#39;blog.urls&#39;))</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></div>

<p>​    全局的 urls 文件中给出了这样的提示，所以只需要模仿它的样子，在全局中去导入 app 和  <code>from django.urls import include</code> 即可</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局的 urls 文件</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> include</span><br><span class="line"><span class="keyword">import</span> app01</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">''</span>, include(<span class="string">'app01.urls'</span>)),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># 应用的 urls 文件</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, re_path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    re_path(<span class="string">r'^articles/([0-9]&#123;4&#125;)/$'</span>, views.year_article),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div>

<p>​    全局的 url 分发的正则部分给了空，也就是说当请求 url 进入匹配时，会被分发到 app01 中的 urls 去进行匹配</p>
<h4 id="url-反向解析"><a href="#url-反向解析" class="headerlink" title="url 反向解析"></a>url 反向解析</h4><p>​    所谓反向解析，是为了在模板中为了渲染 url，但是直接将 urls 中路由填写在模板中显然是不合理的，所以在配置 url 时就有了参数 name，用别名来代替 url，可以更简便的管理 url</p>
<p>​    反向解析的目的就是防止对 url 进行硬编码，以至于在修改了 urls 中的路由后，不用 name 的情况下，就需要一个个去修改模板中的路由，否则就无法进行跳转，并且会在渲染时就会抛出异常</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 反向解析 url ，可以是在视图函数中或是在模板文件中</span><br><span class="line"># 假设 urls 中有一个路由</span><br><span class="line">path(&#39;news&#x2F;index&#39;, views.index，name&#x3D;&#39;news_index&#39;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 视图函数中的应用：</span><br><span class="line">reverse(&quot;news_index&quot;)     # 返回 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;news&#x2F;index</span><br><span class="line"></span><br><span class="line"># 如果路由是一个需要动态参数的话，通过 args 添加</span><br><span class="line">reverse(&quot;news_index&quot;, args&#x3D;(1,))   # 返回 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;news&#x2F;index&#x2F;1&#x2F;</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># 模板中的应用：</span><br><span class="line">&#123;% url &#39;news_index&#39; %&#125;     # 即 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;news&#x2F;index</span><br><span class="line"></span><br><span class="line">&#123;% url &#39;news_index&#39; 1 %&#125;   # 即 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;news&#x2F;index&#x2F;1&#x2F;</span><br></pre></td></tr></table></figure></div>

<h4 id="url-名称空间"><a href="#url-名称空间" class="headerlink" title="url 名称空间"></a>url 名称空间</h4><p>​    即给应用的 url 划定唯一的空间，所以即使出现相同的 url 只要是在不同的应用名称空间中都是允许的，名称空间的定义是在配置 url分发 时，通过参数 namespace 来指定</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">django</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">urlpatterns = [</span></span><br><span class="line"><span class="xml">    path('xxxx/xxx',  include(('app.urls', 'app'), namespace='app'))</span></span><br><span class="line"><span class="xml">]</span></span><br></pre></td></tr></table></figure></div>

<h3 id="HttpRequests-和-HttpResponse-对象"><a href="#HttpRequests-和-HttpResponse-对象" class="headerlink" title="HttpRequests 和 HttpResponse 对象"></a>HttpRequests 和 HttpResponse 对象</h3><p>​    HttpRequests 即 访问的 http 请求，客户端向应用服务器发起请求来获取资源，HTTPResponse 即 http 响应，服务器接收到客户端的请求后将处理后的结果发回给客户端</p>
<h4 id="HttpRequests-对象"><a href="#HttpRequests-对象" class="headerlink" title="HttpRequests 对象"></a>HttpRequests 对象</h4><p>​    当服务器接收到请求后，django 会根据报文创建 HttpRequests 对象，并且会在内部封装一个 request 作为 HttpRequests 对象，而这个 request 就是视图函数中第一个必须的参数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 属性</span><br><span class="line">path          # 请求的全路径，但是不包括域名和端口</span><br><span class="line">method        # 请求的类型，以全大写返回，如 GET，POST</span><br><span class="line">GET           # GET 请求中所有的参数，返回的是一个 QueryDict 对象</span><br><span class="line">POST          # 同上，返回的是 POST 请求中的参数</span><br><span class="line">COOKIES       # 返回请求头中 Cookie 信息，字典形式返回</span><br><span class="line">FILES         # 文件上传的 QueryDict 对象，key 是 input 标签中的 name，而 value 包含 filename(文件名)，content_type(文件 content_type 类型)，content(文件原始内容)</span><br><span class="line">session       # 返回一个 session 对象，可以在 django 的中间件启用</span><br><span class="line">user          # 即当前访问登录的用户对象，是一个 django.contrib.auth.models.User 对象，同样可以在中间件去启用</span><br><span class="line">META          # 包含请求和响应的 headers 中所有的信息，是一个字典格式，且 key 全部都是大写，另外对比浏览器的头部信息，可以看到在请求的头部中，django 给键都加上了 HTTP_ 前缀，所以如果要去添加一个自定义的信息到 META 中，就需要加上必要的前缀</span><br><span class="line">	 CONTENT_LENGTH    # 正文长度</span><br><span class="line">	 CONTENT_TYPE      # 正文的 MIME 类型</span><br><span class="line">	 HTTP_ACCEPT       # 可接受的 Content-Type</span><br><span class="line">	 HTTP_ACCEPT_ENCODING     # 可接受的响应编码类型</span><br><span class="line">	 HTTP_HOST         # 客户端发送的 host 头部</span><br><span class="line">	 HTTP_USER_AGENT   # 客户端的 User-Agent 的字符串</span><br><span class="line">	 REMOTE_ADDR       # 客户端的 ip 地址</span><br><span class="line">	 REMOTE_HOST       # 客户端的主机名</span><br><span class="line">	 REQUEST_METHOD    # 请求方法的字符串，&quot;GET&quot; 等等</span><br><span class="line">	 SERVER_NAME       # 服务器的主机名</span><br><span class="line">	 SERVER_PORT       # 服务器的端口字符串</span><br><span class="line">	 </span><br><span class="line"></span><br><span class="line"># 方法</span><br><span class="line">get_full_path()    # 返回请求的 url，同样没有域名和端口，但是与 path 属性不同，该方法在请求有参数的情况下会返回带有参数的 url</span><br><span class="line">is_ajax()          # 判断请求是否是 AJAX 发起的</span><br></pre></td></tr></table></figure></div>

<h4 id="HttpResponse-对象"><a href="#HttpResponse-对象" class="headerlink" title="HttpResponse 对象"></a>HttpResponse 对象</h4><p>​    请求的 httprequests 是由 django 来自动创建的，进入到视图函数处理完成后，就需要去返回，也就是需要去创建一个相应的 httpresponse 对象</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 常用的方法</span><br><span class="line"></span><br><span class="line">render(request, template_name[, context]）</span><br><span class="line"># 用于直接渲染模板文件或是给定的上下文字典加入到文件一同渲染，最后会返回一个 HttpResponse 对象，视图函数最后只需要 return 这个对象即可</span><br><span class="line"># request，参数是必须的参数，用作响应的请求对象</span><br><span class="line"># template_name，即要渲染的模板文件</span><br><span class="line"># context，可选参数，且是字典结构，渲染文件时会将字典作为上下文传递给模板文件，让其进行渲染</span><br><span class="line"># content_type，可选参数，指定生成的文档使用的 MIME 类型</span><br><span class="line"># status，来指定响应的状态码</span><br><span class="line"></span><br><span class="line">redirect    </span><br><span class="line"># 用于进行页面跳转</span><br><span class="line"></span><br><span class="line">HttpResponse    </span><br><span class="line"># 可以直接将字符串传入，来作为页面内容构造响应对象，请求页面会将字符串显示；也可直接实例化这个响应对象，使用该对象的 write 方法将字符串写入</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HttpResponse 对象举例：</span><br><span class="line">ret &#x3D; HttpResponse(&quot;hello&quot;)</span><br><span class="line">ret &#x3D; render(request, &quot;index.html&quot;)</span><br><span class="line">ret &#x3D; redircet(&quot;&#x2F;index&#x2F;&quot;)    # 这是写死的 url，跳转默认会将当前的域名和端口</span><br></pre></td></tr></table></figure></div>

<h3 id="FBV-和-CBV"><a href="#FBV-和-CBV" class="headerlink" title="FBV 和 CBV"></a>FBV 和 CBV</h3><p>​    FBV：function base views，基于函数的视图，即使用 def 去定义函数作为请求的处理入口</p>
<p>​    CBV：class base views，基于类的视图，即使用面向对象的方式去定义视图，让类作为处理的入口，这样就可以利用类的三大特性，来实现高可用的代码，像 Mixin 的多继承，并且不用像 FBV 中对于同一 url 的不同请求类型需要利用 if 去判断，使用 CBV 将每一个类型请求单独隔离开，这样维护成本就会降低</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyView</span><span class="params">(View)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">'GET'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">'POST'</span>)</span><br></pre></td></tr></table></figure></div>

<p>​    使用 CBV 时，创建的类需要去继承 django.views 的 View，另外要注意，使用 CBV 去编写处理逻辑前，urls 的配置也需要改变，需要在类名后加上 <code>.as_view()</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'index/'</span>, views.MyView.as_view())</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div>

<h3 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"># 渲染变量语法：</span><br><span class="line"></span><br><span class="line">&#123;&#123; 变量名 &#125;&#125;</span><br><span class="line"></span><br><span class="line"># 变量的渲染必须是在 &#123;&#123; &#125;&#125; 之内，且如果变量是一个 list 或 dict 的话，想要渲染其中的某一个值，可以使用 .索引 或 .key 来遍历取出想要的值</span><br><span class="line"># 如果要渲染的这个变量是一个 object 的话，依然可以使用 .属性 或 .方法 获取值，但是 . 后面只能是无参的方法，如果要直接渲染对象，需要在对象内部实现 __str__ 方法</span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># 渲染标签语法：</span><br><span class="line"></span><br><span class="line">&#123;% 标签名 %&#125;</span><br><span class="line"></span><br><span class="line"># 通常不会直接使用这样的方式去渲染出一个简单 html，一般对于标签渲染都会用于需要循环创建的逻辑，比如需要渲染一堆 li 标签等等</span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># 用 for 循环创建标签</span><br><span class="line"></span><br><span class="line">&#123;% for i in [111,222,333] %&#125;</span><br><span class="line">    &lt;p&gt;&#123;&#123; i &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% endfor %&#125; </span><br><span class="line"></span><br><span class="line"># for 循环创建标签并渲染，在最后需要使用 &#123;% endfor %&#125;，如果需要将遍历的序号一起渲染，需要使用 &#123;&#123; forloop.counter &#125;&#125;，这个语法会依次将遍历序号渲染，且是从 1 开始，如果要改为从 0 开始，使用 &#123;&#123; forloop.counter0 &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% for name in name_list %&#125;</span><br><span class="line">    &lt;p&gt;&#123;&#123; name &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% empty %&#125;</span><br><span class="line">	&lt;p&gt; no, name! &lt;&#x2F;p&gt;</span><br><span class="line">&#123;% endfor %&#125; </span><br><span class="line"></span><br><span class="line"># &#123;% empty %&#125; 的标签语法并会渲染任何标签，它会在 for 循环是空的，或是变量找不到的情况下触发，来保证如果使用 for 得不到任何东西时，可以渲染一些提示等等，让操作能完成</span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># 条件判断语法:</span><br><span class="line"></span><br><span class="line">&#123;% if num &lt; 17 %&#125;</span><br><span class="line">    &lt;p&gt;&#123;&#123; num &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% elif num &gt; 5 %&#125;</span><br><span class="line">	&lt;p&gt;&#123;&#123; num + 1&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">	&lt;p&gt;&#123;&#123; num - 10 &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line"># 和 for 循环标签语法一样，使用 if 的条件判断最后一个需要使用 endif</span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">表单提交的标签：</span><br><span class="line"></span><br><span class="line">&#123;% csrf_token %&#125;</span><br><span class="line"></span><br><span class="line"># 这是一个安全机制的标签，csrf 是指跨站请求伪造，跨站即跨域，csrf_token 的标签其实最后渲染后就是一个隐藏的 input 标签，csrf_token 标签不限位置，提交时会自动找到加上</span><br><span class="line"># 例如：&lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;csrfmiddlewaretoken&quot; value&#x3D;&quot;uNHz6h6kVLlSXrMsyA7grL4Ly08D1ewY4kBtm9DnK3b6mC6cWUz8z5tIYCLvqQlw&quot;&gt;</span><br><span class="line"># django 的中间件 django.middleware.csrf.CsrfViewMiddleware 默认是开启，所以在提交发起请求后如果没有添加 csrf_token 的标签，会遇到 403 forbidden 的错误，在测试阶段也可以在 settings 文件的 MIDDLEWARE 中找到 &#39;django.middleware.csrf.CsrfViewMiddleware&#39; 将其注释，表示不启用保护</span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">with 标签：</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&#123;&#123; person_list.2.name &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% with name&#x3D;person_list.2.name %&#125;</span><br><span class="line">    &lt;p&gt;&#123;&#123; name &#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&#123;% endwith %&#125;</span><br><span class="line"></span><br><span class="line"># with 标签相当于是给原本变量起了别名，因为变量可以利用 . 来实现一个链式的获取，就会导致可能需要写很长的一段代码，如果这个值恰好是常用的，就会相对繁琐一些，利用 with 别名去接收原来的值并使用要更加简便</span><br></pre></td></tr></table></figure></div>

<h4 id="模板语法自带的过滤器方法"><a href="#模板语法自带的过滤器方法" class="headerlink" title="模板语法自带的过滤器方法"></a>模板语法自带的过滤器方法</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 没有值或为空的替补值：default</span><br><span class="line">&#123;&#123;  res | default:val &#125;&#125;      # 如果 res 为 false 或 空，使用默认值 val</span><br><span class="line"></span><br><span class="line"># 返回变量的长度：length</span><br><span class="line">&#123;&#123; res | length &#125;&#125;             # 如果变量是一个列表，就返回列表的长度</span><br><span class="line"></span><br><span class="line"># 文件大小格式化：filesizeformat</span><br><span class="line">&#123;&#123; res | filesizeformat &#125;&#125;     # 将 res 转化为合适的存储大小单位，如：KB，MB，bytes...</span><br><span class="line"></span><br><span class="line"># 日期过滤：date</span><br><span class="line">&#123;&#123;  res | date:&#39;Y-m-d&#39; &#125;&#125;     # res 是类似 datetime.datetime.now()，则会根据规定给定的 date 的字符串去格式化</span><br><span class="line"></span><br><span class="line"># 字符串切片过滤器：slice</span><br><span class="line">&#123;&#123; res | slice:&#39;5:7&#39;&#125;&#125;        # 将 res 根据给定范围去截取</span><br><span class="line"></span><br><span class="line"># 字符串截断：truncatechars</span><br><span class="line">&#123;&#123; res | truncatechars:num &#125;&#125;     # 会将 res 整体截取到给定的 nums 的位置，并将最后一个字符替换为 &#39;...&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 单词截断：truncatewords</span><br><span class="line">&#123;&#123; res | truncatewords:num &#125;&#125;     # 同上，按照英文单词截断，每一位表示一个英文单词</span><br><span class="line"></span><br><span class="line"># 例如：s &#x3D; &#39;l am not throwing away my shot, hey yo, l just like my contry, young, scrape and hungry&#39;</span><br><span class="line">使用 &#123;&#123;  res | truncatewords:5 &#125;&#125;，页面显示 &#39;l am not throwing away …&#39;</span><br><span class="line">使用 &#123;&#123;  res | truncatechars:15 &#125;&#125;，页面显示 &#39;l am not throw…&#39;</span><br><span class="line"></span><br><span class="line"># 防止转义</span><br><span class="line">&#123;&#123; res | safe &#125;&#125;             # 如果 res 是包含了 html 标签 或 是 js 代码 的内容需要使用 safe 过滤器防止显示异常，来告知 django 代码是安全的</span><br><span class="line"></span><br><span class="line"># 例如：res &#x3D; &#39;&lt;a href&#x3D;&quot;&quot;&gt;点击&lt;&#x2F;a&gt;&#39;，直接交给模板渲染会将标签也一起作为字符串渲染，页面会显示 &lt;a href&#x3D;&quot;&quot;&gt;点击&lt;&#x2F;a&gt;，使用 &#123;&#123; res | safe &#125;&#125;，则会渲染 a 标签，页面会显示一个可以点击的 &#39;点击&#39;</span><br></pre></td></tr></table></figure></div>

<h4 id="自定义标签与过滤器"><a href="#自定义标签与过滤器" class="headerlink" title="自定义标签与过滤器"></a>自定义标签与过滤器</h4><p>​    在去创建自定义的标签与过滤器之前，需要完成三个前置步骤：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1）在 settings 配置文件中找到 INSTALLED_APPS，并在这个列表中配置上创建的应用名</span><br><span class="line"></span><br><span class="line">2）在创建的应用中，新建一个文件夹作为包，且文件名必须为 &#39;templatetags&#39;</span><br><span class="line"></span><br><span class="line">3）在 &#39;templatetags&#39; 中创建任意名字的 py 文件，作为自定义标签和过滤器的模块</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># templates 中新建 my_tags.py </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> template</span><br><span class="line"><span class="keyword">from</span> django.utils.safestring <span class="keyword">import</span> make_safe     <span class="comment"># make_safe 类似 safe 过滤器</span></span><br><span class="line"></span><br><span class="line">register = template.Library()      <span class="comment"># register 对象只能是这个名字</span></span><br></pre></td></tr></table></figure></div>

<p>​    <strong>自定义过滤器</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@register.filter</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">power</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x**y</span><br></pre></td></tr></table></figure></div>

<p>​    <strong>自定义标签</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@register.simple_tag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_input</span><span class="params">(id, arg)</span>:</span></span><br><span class="line">    content = <span class="string">f"&lt;input type='text' id=<span class="subst">&#123;id&#125;</span> class=<span class="subst">&#123;arg&#125;</span> /&gt;"</span></span><br><span class="line">    <span class="keyword">return</span> mark_safe(content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：</span></span><br><span class="line"><span class="comment">#	使用前，也有一个前置步骤：在要是用自定义过滤器或标签的 html 模板中，使用  &#123;% load my_tags %&#125; 将创建的 my_tags 模块导入</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &#123;% load my_tags %&#125;</span><br><span class="line">    </span><br><span class="line">    &lt;h3&gt;&#123;&#123; num | power:6 &#125;&#125;&lt;&#x2F;h3&gt;</span><br><span class="line">    &#123;% new_input &#39;user&#39; &#39;red&#39; %&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure></div>

<p>​    最后，配合上视图的处理，返回的 html 如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>64<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>     <span class="comment">&lt;!-- 这里视图函数中传递的 num 的值是 2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"red"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>​    <strong>区别：</strong></p>
<p>​    <strong>自定义过滤器</strong> 只能接受 <strong>两个参数</strong>，即定义函数时只能有两个形参，一个参数为模板语法中 ‘|’ 管道符前的变量，第二个参数为自定义过滤器参数，就是管道符后过滤器名后的参数；且自定义过滤器是 <strong>可以配合 if 和 for</strong> 两个逻辑操作</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if num|power:6 &gt;&#x3D; 60 %&#125;      &lt;!-- 这里的管道符左右是不能有空格的 --&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; num|power:6 &#125;&#125;&lt;&#x2F;h3&gt;</span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">    &lt;h3&gt;大于 60&lt;&#x2F;h3&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></div>

<p>​    <strong>自定义标签</strong> 与自定义过滤器相反，<strong>不对参数的个数做限制</strong>，但同样也就 <strong>无法配合 if 和 for</strong> 来使用自定义标签</p>
<h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><p>​    即对于使用相同部分的 html 的文件，可以利用继承来减少模板之前大量的相同地方，通过将需要的结构代码放在 base 之中，利用模板语法继承这个 base 就能实现一样的内容（包括 html 结构 或 css 的样式 或是 js 的代码）</p>
<p>​    <strong>创建继承：</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1）可以选择创建一个 base.html，将可能多个模板都会用到的代码放在该文件中</span><br><span class="line"></span><br><span class="line">2）在需要使用到相同部分的 html 模板文件中，直接利用  &#123;% extends &#39;base.html&#39; %&#125;，就可以实现继承</span><br><span class="line"></span><br><span class="line">3) 这时，再去访问 index，会将 base 中的部分原封不动的搬过来，简单高效；但是，只有继承的话对于那些可能有用相同的部分，但是内容上却不同的不就又无法使用 extends 去继承了，例如相同样式的导航栏，会员与普通用户所看到的导航菜单是不一样的，这就需要使用 钩子 去实现一个可自定制的继承</span><br></pre></td></tr></table></figure></div>

<p>​     <strong>钩子</strong> 的创建也很简单：</p>
<p>​    在 base 的模板文件中，使用 block 标签留出其他模板会添加的部分，或是将一块部分用 block 标签框起来，这样继承 base 的模板就可以实现在这一块的自定制</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># base.html</span><br><span class="line">&#123;% block 钩子名 %&#125;</span><br><span class="line">	....</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure></div>

<p><a href="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/%E6%A8%A1%E6%9D%BF%E7%BB%A7%E6%89%BF.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="img/md5.jpg" class="fancybox"><img alt="img/md5.jpg" title="img/md5.jpg" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/%E6%A8%A1%E6%9D%BF%E7%BB%A7%E6%89%BF.jpg" class="lazyload"></a></p>
<p>​    这样再去访问继承 base 的模板就看到自定制的内容了</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Legacy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://alexham.top/2197405715/">http://alexham.top/2197405715/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://alexham.top"></a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Django/">Django    </a></div><div class="post_share"><div class="social-share" data-image="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover17.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/887545606/"><img class="prev_cover lazyload" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover18.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>LeetCode 原题</span></div></a></div><div class="next-post pull_right"><a href="/3660878595/"><img class="next_cover lazyload" data-src="https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover16.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>JavaScript 逆向爬取实例(下)</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'MHzSjOElX9Cf5IJAfoNr4COL-gzGzoHsz',
  appKey:'K3d5HK6zRMD2BINwstEANt7H',
  placeholder:'留下信息可以快速收到回复~',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-CN',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://alexham.coding.net/p/alexham/d/alexham/git/raw/master/img/cover17.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Legacy</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-sun-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/click_heart.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>